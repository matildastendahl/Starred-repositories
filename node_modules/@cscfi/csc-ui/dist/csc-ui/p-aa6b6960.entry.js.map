{"version":3,"names":["cModalCss","CModal","this","_debounce","_handleShow","_dialog","addEventListener","_onDialogOpened","classList","add","showModal","removeEventListener","remove","_handleClose","_onDialogClosed","close","document","fullscreenElement","exitFullscreen","_handleClickOutside","e","clientX","clientY","dialogDimensions","getBoundingClientRect","left","right","top","bottom","dismissable","clearTimeout","window","setTimeout","changeValue","emit","_handleKeyDown","keyCode","preventDefault","onValueChange","value","componentWillLoad","innerValue","width","isNaN","el","style","setProperty","componentDidLoad","render","dialogStyle","zIndex","classes","disableBackdropBlur","h","ref","class","onKeyDown"],"sources":["src/components/c-modal/c-modal.scss?tag=c-modal&encapsulation=shadow","src/components/c-modal/c-modal.tsx"],"sourcesContent":["dialog {\n  background-color: transparent;\n  border: none;\n  color: var(--c-text-body);\n  inset: 0;\n  margin: auto;\n  max-width: calc(100% - 32px);\n  overflow: visible;\n  padding: 0;\n  width: var(--_c-modal-width, 600px);\n\n  &:not([open]) {\n    pointer-events: none;\n    opacity: 0;\n  }\n\n  &::backdrop {\n    background-color: rgba(0, 0, 0, 0.5);\n  }\n\n  &.backdrop-blur {\n    &::backdrop {\n      backdrop-filter: blur(4px);\n    }\n  }\n}\n\n@media (prefers-reduced-motion: no-preference) {\n  dialog {\n    &.nudging {\n      animation: dialog-nudge 0.15s cubic-bezier(0.25, 0.8, 0.25, 1) !important;\n    }\n\n    &.opening {\n      animation: dialog-open 0.3s cubic-bezier(0.25, 0.8, 0.5, 1) forwards;\n\n      &::backdrop {\n        animation: backdrop-fadein 0.3s forwards;\n      }\n    }\n\n    &.closing {\n      animation: dialog-close 0.3s cubic-bezier(0.25, 0.8, 0.5, 1) forwards;\n\n      &::backdrop {\n        animation: backdrop-fadeout 0.3s forwards;\n      }\n    }\n  }\n}\n\n@keyframes dialog-nudge {\n  0% {\n    transform: scale(1);\n  }\n\n  50% {\n    transform: scale(1.03);\n  }\n\n  100% {\n    transform: scale(1);\n  }\n}\n\n@keyframes dialog-open {\n  from {\n    transform: scale(0);\n  }\n\n  to {\n    transform: scale(1);\n  }\n}\n\n@keyframes dialog-close {\n  to {\n    transform: scale(0);\n  }\n}\n\n@keyframes backdrop-fadein {\n  from {\n    opacity: 0;\n  }\n\n  to {\n    opacity: 1;\n  }\n}\n\n@keyframes backdrop-fadeout {\n  from {\n    opacity: 1;\n  }\n\n  to {\n    opacity: 0;\n  }\n}\n","import {\n  Component,\n  h,\n  Prop,\n  Event,\n  EventEmitter,\n  State,\n  Watch,\n  Element,\n} from '@stencil/core';\n\n/**\n * @group Popups\n */\n@Component({\n  tag: 'c-modal',\n  styleUrl: 'c-modal.scss',\n  shadow: true,\n})\nexport class CModal {\n  @Element() el: HTMLCModalElement;\n\n  private _dialog?: HTMLDialogElement;\n\n  /**\n   * Is the modal visible\n   */\n  @Prop() value = false;\n\n  /**\n   * Dismissed when touching/clicking outside the content\n   */\n  @Prop() dismissable = false;\n\n  /**\n   * Width of the dialog. Numeric value is considered as pixel value (400 -> 400px)\n   *\n   */\n  @Prop() width: string | number = 600;\n\n  /**\n   * Z-index of the modal\n   */\n  @Prop() zIndex = 10;\n\n  /**\n   * Disable backdrop blur effect\n   */\n  @Prop() disableBackdropBlur = false;\n\n  /**\n   * Triggered when value is changed\n   */\n  @Event({ bubbles: false }) changeValue: EventEmitter<boolean>;\n\n  @State() innerValue = false;\n\n  @State() animateModal = false;\n\n  private _debounce = null;\n\n  @Watch('value')\n  onValueChange(value: boolean) {\n    if (value) {\n      this._handleShow();\n\n      return;\n    }\n\n    this._handleClose();\n  }\n\n  private _handleShow = () => {\n    if (this._dialog) {\n      this._dialog.addEventListener('animationend', this._onDialogOpened);\n      this._dialog.classList.add('opening');\n      this._dialog.showModal();\n    }\n  };\n\n  private _onDialogOpened = () => {\n    if (this._dialog) {\n      this._dialog.removeEventListener('animationend', this._onDialogOpened);\n      this._dialog.classList.remove('opening');\n    }\n  };\n\n  private _handleClose = () => {\n    if (this._dialog) {\n      this._dialog.addEventListener('animationend', this._onDialogClosed);\n      this._dialog.classList.add('closing');\n    }\n  };\n\n  private _onDialogClosed = () => {\n    if (this._dialog) {\n      this._dialog.removeEventListener('animationend', this._onDialogClosed);\n      this._dialog.classList.remove('closing');\n      this._dialog.close();\n    }\n\n    if (!document.fullscreenElement) return;\n\n    document.exitFullscreen();\n  };\n\n  private _handleClickOutside = () => {\n    this._dialog.addEventListener('click', (e) => {\n      if (e.clientX === 0 && e.clientY === 0) return;\n\n      const dialogDimensions = this._dialog.getBoundingClientRect();\n\n      if (\n        e.clientX < dialogDimensions.left ||\n        e.clientX > dialogDimensions.right ||\n        e.clientY < dialogDimensions.top ||\n        e.clientY > dialogDimensions.bottom\n      ) {\n        if (!this.dismissable) {\n          this._dialog.classList.add('nudging');\n\n          if (this._debounce !== null) {\n            clearTimeout(this._debounce);\n            this._debounce = null;\n          }\n\n          this._debounce = window.setTimeout(() => {\n            this._dialog.classList.remove('nudging');\n\n            this._debounce = null;\n          }, 150);\n\n          return;\n        }\n\n        this._handleClose();\n        this.changeValue.emit(false);\n      }\n    });\n  };\n\n  private _handleKeyDown = (e) => {\n    if (e.keyCode === 27) {\n      e.preventDefault();\n      this._handleClose();\n      this.changeValue.emit(false);\n    }\n  };\n\n  componentWillLoad() {\n    this.innerValue = this.value;\n\n    const width = isNaN(this.width as number) ? this.width : `${this.width}px`;\n\n    this.el.style.setProperty('--_c-modal-width', `${width}`);\n  }\n\n  componentDidLoad() {\n    this._handleClickOutside();\n\n    if (this.value) {\n      this._handleShow();\n    }\n  }\n\n  render() {\n    const dialogStyle = {\n      'z-index': `${this.zIndex}`,\n    };\n\n    const classes = {\n      'backdrop-blur': !this.disableBackdropBlur,\n    };\n\n    return (\n      <dialog\n        ref={(el) => (this._dialog = el as HTMLDialogElement)}\n        style={dialogStyle}\n        class={classes}\n        onKeyDown={this._handleKeyDown}\n      >\n        <slot></slot>\n      </dialog>\n    );\n  }\n}\n"],"mappings":"yDAAA,MAAMA,EAAY,0wC,MCmBLC,EAAM,M,kEAwCTC,KAAAC,UAAY,KAaZD,KAAAE,YAAc,KACpB,GAAIF,KAAKG,QAAS,CAChBH,KAAKG,QAAQC,iBAAiB,eAAgBJ,KAAKK,iBACnDL,KAAKG,QAAQG,UAAUC,IAAI,WAC3BP,KAAKG,QAAQK,W,GAITR,KAAAK,gBAAkB,KACxB,GAAIL,KAAKG,QAAS,CAChBH,KAAKG,QAAQM,oBAAoB,eAAgBT,KAAKK,iBACtDL,KAAKG,QAAQG,UAAUI,OAAO,U,GAI1BV,KAAAW,aAAe,KACrB,GAAIX,KAAKG,QAAS,CAChBH,KAAKG,QAAQC,iBAAiB,eAAgBJ,KAAKY,iBACnDZ,KAAKG,QAAQG,UAAUC,IAAI,U,GAIvBP,KAAAY,gBAAkB,KACxB,GAAIZ,KAAKG,QAAS,CAChBH,KAAKG,QAAQM,oBAAoB,eAAgBT,KAAKY,iBACtDZ,KAAKG,QAAQG,UAAUI,OAAO,WAC9BV,KAAKG,QAAQU,O,CAGf,IAAKC,SAASC,kBAAmB,OAEjCD,SAASE,gBAAgB,EAGnBhB,KAAAiB,oBAAsB,KAC5BjB,KAAKG,QAAQC,iBAAiB,SAAUc,IACtC,GAAIA,EAAEC,UAAY,GAAKD,EAAEE,UAAY,EAAG,OAExC,MAAMC,EAAmBrB,KAAKG,QAAQmB,wBAEtC,GACEJ,EAAEC,QAAUE,EAAiBE,MAC7BL,EAAEC,QAAUE,EAAiBG,OAC7BN,EAAEE,QAAUC,EAAiBI,KAC7BP,EAAEE,QAAUC,EAAiBK,OAC7B,CACA,IAAK1B,KAAK2B,YAAa,CACrB3B,KAAKG,QAAQG,UAAUC,IAAI,WAE3B,GAAIP,KAAKC,YAAc,KAAM,CAC3B2B,aAAa5B,KAAKC,WAClBD,KAAKC,UAAY,I,CAGnBD,KAAKC,UAAY4B,OAAOC,YAAW,KACjC9B,KAAKG,QAAQG,UAAUI,OAAO,WAE9BV,KAAKC,UAAY,IAAI,GACpB,KAEH,M,CAGFD,KAAKW,eACLX,KAAK+B,YAAYC,KAAK,M,IAExB,EAGIhC,KAAAiC,eAAkBf,IACxB,GAAIA,EAAEgB,UAAY,GAAI,CACpBhB,EAAEiB,iBACFnC,KAAKW,eACLX,KAAK+B,YAAYC,KAAK,M,cAtHV,M,iBAKM,M,WAMW,I,YAKhB,G,yBAKa,M,gBAOR,M,kBAEE,K,CAKxB,aAAAI,CAAcC,GACZ,GAAIA,EAAO,CACTrC,KAAKE,cAEL,M,CAGFF,KAAKW,c,CAgFP,iBAAA2B,GACEtC,KAAKuC,WAAavC,KAAKqC,MAEvB,MAAMG,EAAQC,MAAMzC,KAAKwC,OAAmBxC,KAAKwC,MAAQ,GAAGxC,KAAKwC,UAEjExC,KAAK0C,GAAGC,MAAMC,YAAY,mBAAoB,GAAGJ,I,CAGnD,gBAAAK,GACE7C,KAAKiB,sBAEL,GAAIjB,KAAKqC,MAAO,CACdrC,KAAKE,a,EAIT,MAAA4C,GACE,MAAMC,EAAc,CAClB,UAAW,GAAG/C,KAAKgD,UAGrB,MAAMC,EAAU,CACd,iBAAkBjD,KAAKkD,qBAGzB,OACEC,EAAA,UACEC,IAAMV,GAAQ1C,KAAKG,QAAUuC,EAC7BC,MAAOI,EACPM,MAAOJ,EACPK,UAAWtD,KAAKiC,gBAEhBkB,EAAA,a"}